Content-Length: 5825

{"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":20556,"clientInfo":{"name":"Visual Studio Code","version":"1.97.2"},"locale":"en","rootPath":"d:\\Lean\\Lean4_byJLJ","rootUri":"file:///d%3A/Lean/Lean4_byJLJ","capabilities":{"workspace":{"applyEdit":true,"workspaceEdit":{"documentChanges":true,"resourceOperations":["create","rename","delete"],"failureHandling":"textOnlyTransactional","normalizesLineEndings":true,"changeAnnotationSupport":{"groupsOnLabel":true}},"configuration":true,"didChangeWatchedFiles":{"dynamicRegistration":true,"relativePatternSupport":true},"symbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"tagSupport":{"valueSet":[1]},"resolveSupport":{"properties":["location.range"]}},"codeLens":{"refreshSupport":true},"executeCommand":{"dynamicRegistration":true},"didChangeConfiguration":{"dynamicRegistration":true},"semanticTokens":{"refreshSupport":true},"fileOperations":{"dynamicRegistration":true,"didCreate":true,"didRename":true,"didDelete":true,"willCreate":true,"willRename":true,"willDelete":true},"inlineValue":{"refreshSupport":true},"inlayHint":{"refreshSupport":true},"diagnostics":{"refreshSupport":true}},"textDocument":{"publishDiagnostics":{"relatedInformation":true,"versionSupport":false,"tagSupport":{"valueSet":[1,2]},"codeDescriptionSupport":true,"dataSupport":true},"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"contextSupport":true,"completionItem":{"snippetSupport":true,"commitCharactersSupport":true,"documentationFormat":["markdown","plaintext"],"deprecatedSupport":true,"preselectSupport":true,"tagSupport":{"valueSet":[1]},"insertReplaceSupport":true,"resolveSupport":{"properties":["documentation","detail","additionalTextEdits"]},"insertTextModeSupport":{"valueSet":[1,2]},"labelDetailsSupport":true},"insertTextMode":2,"completionItemKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]},"completionList":{"itemDefaults":["commitCharacters","editRange","insertTextFormat","insertTextMode"]}},"hover":{"dynamicRegistration":true,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":true,"signatureInformation":{"documentationFormat":["markdown","plaintext"],"parameterInformation":{"labelOffsetSupport":true},"activeParameterSupport":true},"contextSupport":true},"definition":{"dynamicRegistration":true,"linkSupport":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"hierarchicalDocumentSymbolSupport":true,"tagSupport":{"valueSet":[1]},"labelSupport":true},"codeAction":{"dynamicRegistration":true,"isPreferredSupport":true,"disabledSupport":true,"dataSupport":true,"resolveSupport":{"properties":["edit"]},"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}},"honorsChangeAnnotations":false},"codeLens":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true,"prepareSupport":true,"prepareSupportDefaultBehavior":1,"honorsChangeAnnotations":true},"documentLink":{"dynamicRegistration":true,"tooltipSupport":true},"typeDefinition":{"dynamicRegistration":true,"linkSupport":true},"implementation":{"dynamicRegistration":true,"linkSupport":true},"colorProvider":{"dynamicRegistration":true},"foldingRange":{"dynamicRegistration":true,"rangeLimit":5000,"lineFoldingOnly":true,"foldingRangeKind":{"valueSet":["comment","imports","region"]},"foldingRange":{"collapsedText":false}},"declaration":{"dynamicRegistration":true,"linkSupport":true},"selectionRange":{"dynamicRegistration":true},"callHierarchy":{"dynamicRegistration":true},"semanticTokens":{"dynamicRegistration":true,"tokenTypes":["namespace","type","class","enum","interface","struct","typeParameter","parameter","variable","property","enumMember","event","function","method","macro","keyword","modifier","comment","string","number","regexp","operator","decorator"],"tokenModifiers":["declaration","definition","readonly","static","deprecated","abstract","async","modification","documentation","defaultLibrary"],"formats":["relative"],"requests":{"range":true,"full":{"delta":true}},"multilineTokenSupport":false,"overlappingTokenSupport":false,"serverCancelSupport":true,"augmentsSyntaxTokens":true},"linkedEditingRange":{"dynamicRegistration":true},"typeHierarchy":{"dynamicRegistration":true},"inlineValue":{"dynamicRegistration":true},"inlayHint":{"dynamicRegistration":true,"resolveSupport":{"properties":["tooltip","textEdits","label.tooltip","label.location","label.command"]}},"diagnostic":{"dynamicRegistration":true,"relatedDocumentSupport":false}},"window":{"showMessage":{"messageActionItem":{"additionalPropertiesSupport":true}},"showDocument":{"support":true},"workDoneProgress":true},"general":{"staleRequestSupport":{"cancel":true,"retryOnContentModified":["textDocument/semanticTokens/full","textDocument/semanticTokens/range","textDocument/semanticTokens/full/delta"]},"regularExpressions":{"engine":"ECMAScript","version":"ES2020"},"markdown":{"parser":"marked","version":"1.1.0"},"positionEncodings":["utf-16"]},"notebookDocument":{"synchronization":{"dynamicRegistration":true,"executionSummarySupport":true}}},"initializationOptions":{"editDelay":200,"hasWidgets":true},"trace":"off","workspaceFolders":[{"uri":"file:///d%3A/Lean/Lean4_byJLJ","name":"Lean4_byJLJ"}]}}Content-Length: 52

{"jsonrpc":"2.0","method":"initialized","params":{}}Content-Length: 7662

{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean","languageId":"lean4","version":1,"text":"import Mathlib.Tactic\nimport Mathlib.Analysis.Calculus.ParametricIntegral\nimport Mathlib.Analysis.Calculus.ContDiff.Defs\nimport Mathlib.Analysis.SpecialFunctions.Trigonometric.Deriv\nimport Mathlib.Analysis.Calculus.Deriv.Abs\nimport Mathlib.Analysis.Calculus.InverseFunctionTheorem.ContDiff\nimport Mathlib.Topology.Basic\nimport Mathlib.Topology.Homeomorph\nimport Mathlib.Order.Interval.Set.Defs\n\n/-\n\n# Smooth functions\n\n-/\n\nnoncomputable def φ₁ : ℝ → ℝ × ℝ := fun x => (Real.cos x, Real.sin x)\n\n-- `ContDiffOn.prod` is a thing etc etc\nexample : ContDiffOn ℝ ⊤ φ₁ (Set.Icc 0 1) := by\n  apply ContDiffOn.prod\n  apply ContDiff.contDiffOn\n  exact Real.contDiff_cos\n  apply ContDiff.contDiffOn\n  exact Real.contDiff_sin\n\n\n\nopen Real\nopen Set\n\nnoncomputable def φ₂ : ℝ → ℝ × ℝ × ℝ := fun x => (Real.sin x, x ^ 4 + 37 * x ^ 2 + 1, abs x)\n\nexample : ContDiffOn ℝ ⊤ φ₂ (Set.Icc 0 1) := by\n  apply ContDiffOn.prod\n  apply ContDiff.contDiffOn\n  exact Real.contDiff_sin\n  apply ContDiffOn.prod\n  apply ContDiff.contDiffOn\n  apply ContDiff.add\n  apply ContDiff.add\n  apply ContDiff.pow\n  apply contDiff_id\n  apply ContDiff.mul\n  apply contDiff_const\n  apply ContDiff.pow\n  apply contDiff_id\n  apply contDiff_const\n  apply contDiffOn_id.congr\n  simp\n  intro h h1 h2\n  exact h1\n\n\n\n\n\n-- AFAIK nobody did the below example yet (including me)\n/- Let `a≤b` and `c≤d` be reals. Let φ : [a,b] → [c,d] and ψ : [c,d] → [a,b]\n  be inverse bijections, and assume φ is smooth and φ' is nonvanishing\n  on [a,b]. Then ψ is smooth and ψ' is nonvanishing on [c,d],\n  and ψ'(y)*φ'(ψ(y))=1.\n-/\nexample (φ : ℝ → ℝ) (ψ : ℝ → ℝ) (a b c d : ℝ) (hab : a ≤ b) (hcd : c ≤ d)\n    (hφ : ∀ x, x ∈ Set.Icc a b → φ x ∈ Set.Icc c d)\n    (hψ : ∀ y, y ∈ Set.Icc c d → ψ y ∈ Set.Icc a b)\n    (left_inv : ∀ x, x ∈ Set.Icc a b → ψ (φ x) = x)\n    (right_inv : ∀ y, y ∈ Set.Icc c d → φ (ψ y) = y)\n    (hφdiff : ContDiffOn ℝ ⊤ φ (Set.Icc a b))\n    (hφregular : ∀ x, x ∈ Set.Icc a b → fderiv ℝ φ x ≠ 0) :\n    ContDiffOn ℝ ⊤ ψ (Set.Icc c d) ∧\n      ∀ y, y ∈ Set.Icc c d → ∀ z, fderiv ℝ ψ y (fderiv ℝ φ (ψ y) z) = z := by\n\n      have hψ_hom : ∀ y ∈ Set.Icc c d, ∃ z ∈ Set.Icc a b, φ z = y := by\n        intro y hy\n        use ψ y\n        constructor\n        apply hψ at hy\n        exact hy\n        apply right_inv at hy\n        exact hy\n\n      have φ_injective_on_Icc : Set.InjOn φ (Set.Icc a b) := by\n        intro x hx y hy hxy\n        apply left_inv at hx\n        rw [hxy] at hx\n        apply left_inv at hy\n        rw [← hx]\n        exact hy\n      have φ_inv_of_ψ : Set.InvOn φ ψ (Set.Icc c d) (Set.Icc a b) := by\n        constructor\n        exact right_inv\n        exact left_inv\n\n      have RR_hom : ℝ ≃ₜ ℝ := by\n        exact Homeomorph.refl ℝ\n\n      have φ'regular : ∀ x ∈ Set.Icc a b, φ' x ≠ 0 := by\n        intro x hx\n        apply hφregular\n        exact hx\n\n\n      have hψdiff : ContDiffOn ℝ ⊤ ψ (Icc c d) := by\n        apply Homeomorph.contDiff_symm_deriv RR_hom φ'regular hψ_hom φ_injective_on_Icc φ_inv_of_ψ\n\n      constructor\n      exact hψdiff\n\n      /-proof of the second part\n      -/\n\n\n\n\n      intro y hy\n      have hyab : ψ y ∈ Icc a b := hψ y hy\n      have hφreg : fderiv ℝ φ (ψ y) ≠ 0 := hφregular (ψ y) (hψ y hy)\n      have hφψ : φ (ψ y) = y := right_inv y hy\n      cases' hy with hcy hdy\n      cases' lt_or_eq_of_le hdy with hdy_lt hdy_eq\n      cases' lt_or_eq_of_le hcy with hcy_lt hcy_eq\n      cases' hyab with hyab_a hyab_b\n      cases' lt_or_eq_of_le hyab_a with hyab_a_lt hyab_a_eq\n      cases' lt_or_eq_of_le hyab_b with hyab_b_lt hyab_b_eq\n\n\n\n      have hψdiff_at : ContDiffAt ℝ ⊤ ψ y := by\n        /-cases' hy with hcy hdy-/\n        apply ContDiffOn.contDiffAt\n        exact hψdiff\n        simp\n        constructor\n        exact hcy_lt\n        exact hdy_lt\n        /-cases' lt_or_eq_of_le hdy with hdy_lt hdy_eq\n        cases' lt_or_eq_of_le hcy with hcy_lt hcy_eq\n        exact hcy_lt\n        exact hdy_lt\n        -/\n\n\n      have hψy : HasStrictFDerivAt ψ (fderiv ℝ ψ y) y := by\n        apply ContDiffAt.hasStrictFDerivAt\n        exact hψdiff_at\n        simp\n\n      have hφψdiff_at : ContDiffAt ℝ ⊤ φ (ψ y) := by\n        apply ContDiffOn.contDiffAt\n        exact hφdiff\n        simp\n        constructor\n        exact hyab_a_lt\n        exact hyab_b_lt\n        /-\n        cases' hyab with hyab_a hyab_b\n        cases' lt_or_eq_of_le hyab_a with hyab_a_lt hyab_a_eq\n        cases' lt_or_eq_of_le hyab_b with hyab_b_lt hyab_b_eq\n        simp\n        constructor\n        exact hyab_a_lt\n        exact hyab_b_lt\n        -/\n\n\n\n      have hφψy : HasStrictFDerivAt φ (fderiv ℝ φ (ψ y)) (ψ y) := by\n        apply ContDiffAt.hasStrictFDerivAt\n        exact hφψdiff_at\n        /-dont know why simp doesnt work at here-/\n\n      have fderiv_id: (fderiv ℝ ψ y) ∘ ((fderiv ℝ φ (ψ y))) = id := by\n        have h_comp := HasStrictFDerivAt.comp_hasStrictDerivAt hψy hφψy\n        exact h_comp\n\n      have fderiv_id' : ∀ z, fderiv ℝ ψ y (fderiv ℝ φ (ψ y) z) = z := by\n        intro z\n        have h_comp := congr_fun fderiv_id z\n        exact h_comp\n\n      exact fderiv_id'\n\n      have hψ_deriv : HasFDerivAt ψ (fderiv ℝ ψ y) y := by\n        apply DifferentiableOn.hasFDerivAt\n        apply ContDiffOn.differentiableOn hψdiff\n        simp\n        rw [mem_nhds_iff]\n        have cd_open: y ∈ (Set.Ioo c d) := by\n          rw [Set.mem_Ioo]\n          constructor\n          exact hcy_lt\n          exact hdy_lt\n        \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/-\n      have hφ_local_inv : ∀ x ∈ Set.Icc a b, HasFDerivAt φ (fderiv ℝ φ x) x := by\n        intro x hx\n        apply DifferentiableOn.hasFDerivAt\n        apply ContDiffOn.differentiableOn hφdiff\n        simp\n        rw [mem_nhds_iff]\n        cases' hx with hax hbx\n\n      constructor\n      apply ContDiffOn.of_local_inverse\n\n      intro y hy z\n      have hφψ : φ (ψ y) = y := right_inv y hy\n      have hψφ : ψ (φ (ψ y)) = ψ y := congr_arg ψ hφψ\n      rw [left_inv (ψ y) (hψ y hy)] at hψφ\n\n      have hψ_deriv : HasFDerivAt ψ (fderiv ℝ ψ y) y := by\n        apply DifferentiableOn.hasFDerivAt\n        apply ContDiffOn.differentiableOn hψdiff\n        simp\n        rw [mem_nhds_iff]\n        cases' hy with hcy hdy\n\n      have hφ_deriv : HasFDerivAt φ (fderiv ℝ φ (ψ y)) (ψ y) := by\n        apply hφ_local_inv\n        apply hψ\n        exact hy\n-\\\n\n\n/-\nHeather Macbeth: @Kevin Buzzard This is a toy case of the inverse function theorem,\nbut you might need to glue together several related results. Some starting points:\ndocs#ContDiffAt.to_localInverse, docs#HasStrictFDerivAt.localInverse_unique\n\nHeather Macbeth: If you want to construct the inverse, and you want to avoid invoking\nthe inverse function theorem on Banach spaces, you can also route through order theory\nfor a purely one-dimensional construction. Look at the construction of docs#Real.arctan\nfor a model; it uses docs#StrictMonoOn.orderIso\n-/\n"},"dependencyBuildMode":"always"}}Content-Length: 179

{"jsonrpc":"2.0","id":1,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 60

{"jsonrpc":"2.0","id":"register_lean_watcher","result":null}Content-Length: 177

{"jsonrpc":"2.0","id":2,"method":"textDocument/foldingRange","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 179

{"jsonrpc":"2.0","id":3,"method":"textDocument/documentSymbol","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 263

{"jsonrpc":"2.0","id":4,"method":"textDocument/semanticTokens/range","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"range":{"start":{"line":143,"character":0},"end":{"line":228,"character":0}}}}Content-Length: 184

{"jsonrpc":"2.0","id":5,"method":"textDocument/semanticTokens/full","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 153

{"jsonrpc":"2.0","id":6,"method":"$/lean/rpc/connect","params":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}Content-Length: 436

{"jsonrpc":"2.0","id":7,"method":"$/lean/rpc/call","params":{"method":"Lean.Widget.getInteractiveGoals","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"position":{"line":193,"character":8}},"sessionId":"5115273963413605028","position":{"line":193,"character":8},"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 439

{"jsonrpc":"2.0","id":8,"method":"$/lean/rpc/call","params":{"method":"Lean.Widget.getInteractiveTermGoal","params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"position":{"line":193,"character":8}},"sessionId":"5115273963413605028","position":{"line":193,"character":8},"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 397

{"jsonrpc":"2.0","id":9,"method":"$/lean/rpc/call","params":{"method":"Lean.Widget.getWidgets","params":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean","line":193,"character":8},"sessionId":"5115273963413605028","position":{"line":193,"character":8},"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 336

{"jsonrpc":"2.0","id":10,"method":"$/lean/rpc/call","params":{"method":"Lean.Widget.getInteractiveDiagnostics","params":{"lineRange":{"start":193,"end":194}},"sessionId":"5115273963413605028","position":{"line":193,"character":8},"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}}}Content-Length: 38

{"jsonrpc":"2.0","id":0,"result":null}