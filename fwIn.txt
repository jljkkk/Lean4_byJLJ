Content-Length: 1004

{"params":{"workspaceFolders":[{"uri":"file:///d%3A/Lean/Lean4_byJLJ","name":"Lean4_byJLJ"}],"trace":"off","rootUri":"file:///d%3A/Lean/Lean4_byJLJ","processId":14488,"initializationOptions":{"hasWidgets":true,"editDelay":200},"clientInfo":{"version":"1.97.0","name":"Visual Studio Code"},"capabilities":{"workspace":{"workspaceEdit":{"resourceOperations":["create","rename","delete"],"documentChanges":true,"changeAnnotationSupport":{"groupsOnLabel":true}},"applyEdit":true},"window":{"showDocument":{"support":true}},"textDocument":{"completion":{"completionItem":{"insertReplaceSupport":true}},"codeAction":{"resolveSupport":{"properties":["edit"]},"isPreferredSupport":true,"honorsChangeAnnotations":false,"dynamicRegistration":true,"disabledSupport":true,"dataSupport":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}}}}}},"method":"initialize","jsonrpc":"2.0","id":0}Content-Length: 5556

{"params":{"textDocument":{"version":5,"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean","text":"import Mathlib.Tactic\nimport Mathlib.Analysis.Calculus.ParametricIntegral\nimport Mathlib.Analysis.Calculus.ContDiff.Defs\nimport Mathlib.Analysis.SpecialFunctions.Trigonometric.Deriv\nimport Mathlib.Analysis.Calculus.Deriv.Abs\nimport Mathlib.Analysis.Calculus.InverseFunctionTheorem.ContDiff\nimport Mathlib.Topology.Basic\nimport Mathlib.Topology.Homeomorph\n\n/-\n\n# Smooth functions\n\n-/\n\nnoncomputable def φ₁ : ℝ → ℝ × ℝ := fun x => (Real.cos x, Real.sin x)\n\n-- `ContDiffOn.prod` is a thing etc etc\nexample : ContDiffOn ℝ ⊤ φ₁ (Set.Icc 0 1) := by\n  apply ContDiffOn.prod\n  apply ContDiff.contDiffOn\n  exact Real.contDiff_cos\n  apply ContDiff.contDiffOn\n  exact Real.contDiff_sin\n\n\n\nopen Real\nopen Set\n\nnoncomputable def φ₂ : ℝ → ℝ × ℝ × ℝ := fun x => (Real.sin x, x ^ 4 + 37 * x ^ 2 + 1, abs x)\n\nexample : ContDiffOn ℝ ⊤ φ₂ (Set.Icc 0 1) := by\n  apply ContDiffOn.prod\n  apply ContDiff.contDiffOn\n  exact Real.contDiff_sin\n  apply ContDiffOn.prod\n  apply ContDiff.contDiffOn\n  apply ContDiff.add\n  apply ContDiff.add\n  apply ContDiff.pow\n  apply contDiff_id\n  apply ContDiff.mul\n  apply contDiff_const\n  apply ContDiff.pow\n  apply contDiff_id\n  apply contDiff_const\n  apply contDiffOn_id.congr\n  simp\n  intro h h1 h2\n  exact h1\n\n\n\n\n\n-- AFAIK nobody did the below example yet (including me)\n/- Let `a≤b` and `c≤d` be reals. Let φ : [a,b] → [c,d] and ψ : [c,d] → [a,b]\n  be inverse bijections, and assume φ is smooth and φ' is nonvanishing\n  on [a,b]. Then ψ is smooth and ψ' is nonvanishing on [c,d],\n  and ψ'(y)*φ'(ψ(y))=1.\n-/\nexample (φ : ℝ → ℝ) (ψ : ℝ → ℝ) (a b c d : ℝ) (hab : a ≤ b) (hcd : c ≤ d)\n    (hφ : ∀ x, x ∈ Set.Icc a b → φ x ∈ Set.Icc c d)\n    (hψ : ∀ y, y ∈ Set.Icc c d → ψ y ∈ Set.Icc a b)\n    (left_inv : ∀ x, x ∈ Set.Icc a b → ψ (φ x) = x)\n    (right_inv : ∀ y, y ∈ Set.Icc c d → φ (ψ y) = y)\n    (hφdiff : ContDiffOn ℝ ⊤ φ (Set.Icc a b))\n    (hφregular : ∀ x, x ∈ Set.Icc a b → fderiv ℝ φ x ≠ 0) :\n    ContDiffOn ℝ ⊤ ψ (Set.Icc c d) ∧\n      ∀ y, y ∈ Set.Icc c d → ∀ z, fderiv ℝ ψ y (fderiv ℝ φ (ψ y) z) = z := by\n\n      have hψ_hom : ∀ y ∈ Set.Icc c d, ∃ z ∈ Set.Icc a b, φ z = y := by\n        intro y hy\n        use ψ y\n        constructor\n        apply hψ at hy\n        exact hy\n        apply right_inv at hy\n        exact hy\n\n      have φ_injective_on_Icc : Set.InjOn φ (Set.Icc a b) := by\n        intro x hx y hy hxy\n        apply left_inv at hx\n        rw [hxy] at hx\n        apply left_inv at hy\n        rw [← hx]\n        exact hy\n      have φ_inv_of_ψ : Set.InvOn φ ψ (Set.Icc c d) (Set.Icc a b) := by\n        constructor\n        exact right_inv\n        exact left_inv\n\n      have RR_hom : ℝ ≃ₜ ℝ := by\n        exact Homeomorph.refl ℝ\n\n      have φ'regular : ∀ x ∈ Set.Icc a b, φ' x ≠ 0 := by\n        intro x hx\n        apply hφregular\n        exact hx\n\n\n      have hψdiff : ContDiffOn ℝ ⊤ ψ (Icc c d) := by\n        apply Homeomorph.contDiff_symm_deriv RR_hom φ'regular hψ_hom φ_injective_on_Icc φ_inv_of_ψ\n\n      constructor\n      exact hψdiff\n\n      intro y hy\n      have hyab : ψ y ∈ Icc a b := hψ y hy\n      have hφreg : fderiv ℝ φ (ψ y) ≠ 0 := hφregular (ψ y) (hψ y hy)\n      have hφψ : φ (ψ y) = y := right_inv y hy\n\n\n      have hψy : HasStrictFDerivAt ψ (fderiv ℝ ψ y) y := by\n        \n\n      have hφψy : HasStrictFDerivAt φ (fderiv ℝ φ (ψ y)) (ψ y) := by\n\n        exact hφ_strict.of_local_left_inverse hφ_strict hφψ hφreg\n\n      apply HasStrictFDerivAt.to_localInverse at hφψy\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/-\n      have hφ_local_inv : ∀ x ∈ Set.Icc a b, HasFDerivAt φ (fderiv ℝ φ x) x := by\n        intro x hx\n        apply DifferentiableOn.hasFDerivAt\n        apply ContDiffOn.differentiableOn hφdiff\n        simp\n        rw [mem_nhds_iff]\n        cases' hx with hax hbx\n\n      constructor\n      apply ContDiffOn.of_local_inverse\n\n      intro y hy z\n      have hφψ : φ (ψ y) = y := right_inv y hy\n      have hψφ : ψ (φ (ψ y)) = ψ y := congr_arg ψ hφψ\n      rw [left_inv (ψ y) (hψ y hy)] at hψφ\n\n      have hψ_deriv : HasFDerivAt ψ (fderiv ℝ ψ y) y := by\n        apply DifferentiableOn.hasFDerivAt\n        apply ContDiffOn.differentiableOn hψdiff\n        simp\n        rw [mem_nhds_iff]\n        cases' hy with hcy hdy\n\n      have hφ_deriv : HasFDerivAt φ (fderiv ℝ φ (ψ y)) (ψ y) := by\n        apply hφ_local_inv\n        apply hψ\n        exact hy\n-\\\n\n\n/-\nHeather Macbeth: @Kevin Buzzard This is a toy case of the inverse function theorem,\nbut you might need to glue together several related results. Some starting points:\ndocs#ContDiffAt.to_localInverse, docs#HasStrictFDerivAt.localInverse_unique\n\nHeather Macbeth: If you want to construct the inverse, and you want to avoid invoking\nthe inverse function theorem on Banach spaces, you can also route through order theory\nfor a purely one-dimensional construction. Look at the construction of docs#Real.arctan\nfor a model; it uses docs#StrictMonoOn.orderIso\n-/\n","languageId":"lean"},"dependencyBuildMode":"always"},"method":"textDocument/didOpen","jsonrpc":"2.0"}Content-Length: 179

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}},"method":"textDocument/documentSymbol","jsonrpc":"2.0","id":1}Content-Length: 153

{"params":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"method":"$/lean/rpc/connect","jsonrpc":"2.0","id":2}Content-Length: 177

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}},"method":"textDocument/foldingRange","jsonrpc":"2.0","id":3}Content-Length: 179

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}},"method":"textDocument/documentSymbol","jsonrpc":"2.0","id":4}Content-Length: 184

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"}},"method":"textDocument/semanticTokens/full","jsonrpc":"2.0","id":5}Content-Length: 436

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"sessionId":"2561953200730702755","position":{"line":115,"character":8},"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"position":{"line":115,"character":8}},"method":"Lean.Widget.getInteractiveGoals"},"method":"$/lean/rpc/call","jsonrpc":"2.0","id":6}Content-Length: 263

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"range":{"start":{"line":74,"character":0},"end":{"line":159,"character":30}}},"method":"textDocument/semanticTokens/range","jsonrpc":"2.0","id":7}Content-Length: 439

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"sessionId":"2561953200730702755","position":{"line":115,"character":8},"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"position":{"line":115,"character":8}},"method":"Lean.Widget.getInteractiveTermGoal"},"method":"$/lean/rpc/call","jsonrpc":"2.0","id":8}Content-Length: 397

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"sessionId":"2561953200730702755","position":{"line":115,"character":8},"params":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean","line":115,"character":8},"method":"Lean.Widget.getWidgets"},"method":"$/lean/rpc/call","jsonrpc":"2.0","id":9}Content-Length: 336

{"params":{"textDocument":{"uri":"file:///d%3A/Lean/Lean4_byJLJ/Lean4ByJLJ/Section17CurvesAndSufaces/Curves3.lean"},"sessionId":"2561953200730702755","position":{"line":115,"character":8},"params":{"lineRange":{"start":115,"end":116}},"method":"Lean.Widget.getInteractiveDiagnostics"},"method":"$/lean/rpc/call","jsonrpc":"2.0","id":10}Content-Length: 38

{"result":null,"jsonrpc":"2.0","id":0}